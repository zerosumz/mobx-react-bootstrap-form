import{action,computed,observable}from"mobx";import React from"react";import PropTypes from"prop-types";import{FormControl}from"react-bootstrap";import{observer}from"mobx-react";var _class,_temp,_dec,_class$1,_descriptor,_descriptor2,_descriptor3,classCallCheck=function(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")},createClass=function(){function e(e,r){for(var t=0;t<r.length;t++){var o=r[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(r,t,o){return t&&e(r.prototype,t),o&&e(r,o),r}}(),_extends=Object.assign||function(e){for(var r=1;r<arguments.length;r++){var t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},inherits=function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Super expression must either be null or a function, not "+typeof r);e.prototype=Object.create(r&&r.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),r&&(Object.setPrototypeOf?Object.setPrototypeOf(e,r):e.__proto__=r)},possibleConstructorReturn=function(e,r){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!r||"object"!=typeof r&&"function"!=typeof r?e:r},toConsumableArray=function(e){if(Array.isArray(e)){for(var r=0,t=Array(e.length);r<e.length;r++)t[r]=e[r];return t}return Array.from(e)},Validation=(_temp=_class=function(){function e(r,t){classCallCheck(this,e),this.rule=null,this.message=null,this.rule=r,this.message=t}return createClass(e,[{key:"isValid",value:function(e){return this.rule instanceof RegExp&&!this.rule.test(e)||this.rule instanceof Function&&!this.rule(e)}}]),e}(),_class.EMAIL_REGEX=/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,_class.REQUIRED_REGEX=/^.+$/,_temp);function _initDefineProp(e,r,t,o){t&&Object.defineProperty(e,r,{enumerable:t.enumerable,configurable:t.configurable,writable:t.writable,value:t.initializer?t.initializer.call(o):void 0})}function _applyDecoratedDescriptor(e,r,t,o,a){var i={};return Object.keys(o).forEach(function(e){i[e]=o[e]}),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=t.slice().reverse().reduce(function(t,o){return o(e,r,t)||t},i),a&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(a):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,r,i),i=null),i}var _class$2,FormStore=(_dec=action.bound,_class$1=function(){function e(){classCallCheck(this,e),_initDefineProp(this,"valueMap",_descriptor,this),_initDefineProp(this,"hasTried",_descriptor2,this),this.validationMap=new Map,_initDefineProp(this,"refs",_descriptor3,this)}return createClass(e,[{key:"clear",value:function(){this.hasTried.clear(),this.valueMap.clear()}},{key:"getErrorMessages",value:function(e){return this.errorMessagesMap.get(e)||[]}},{key:"invalidationsMap",get:function(){var e=this,r=new Map;return this.valueMap.forEach(function(t,o){var a=(e.validationMap.get(o)||[]).filter(function(e){return e.isValid(t)});a&&a.length>0&&r.set(o,a)}),r}},{key:"firstErrorMessage",get:function(){var e=[].concat(toConsumableArray(this.invalidationsMap.entries()))[0],r=void 0;return e&&e.length>1&&(r=e[1]),e&&r[0]?r[0].message:null}},{key:"firstInvalidRef",get:function(){var e=[].concat(toConsumableArray(this.invalidationsMap.entries()))[0];if(e&&e.length>1){var r=e[0];return this.refs.get(r)}}},{key:"valid",get:function(){return 0===this.invalidationsMap.size}},{key:"errorMessagesMap",get:function(){var e=new Map;return this.invalidationsMap.forEach(function(r,t){e.set(t,r.map(function(e){return e.message}))}),e}}]),e}(),_descriptor=_applyDecoratedDescriptor(_class$1.prototype,"valueMap",[observable],{enumerable:!0,initializer:function(){return new Map}}),_descriptor2=_applyDecoratedDescriptor(_class$1.prototype,"hasTried",[observable],{enumerable:!0,initializer:function(){return new Map}}),_descriptor3=_applyDecoratedDescriptor(_class$1.prototype,"refs",[observable],{enumerable:!0,initializer:function(){return new Map}}),_applyDecoratedDescriptor(_class$1.prototype,"clear",[_dec],Object.getOwnPropertyDescriptor(_class$1.prototype,"clear"),_class$1.prototype),_applyDecoratedDescriptor(_class$1.prototype,"invalidationsMap",[computed],Object.getOwnPropertyDescriptor(_class$1.prototype,"invalidationsMap"),_class$1.prototype),_applyDecoratedDescriptor(_class$1.prototype,"firstErrorMessage",[computed],Object.getOwnPropertyDescriptor(_class$1.prototype,"firstErrorMessage"),_class$1.prototype),_applyDecoratedDescriptor(_class$1.prototype,"firstInvalidRef",[computed],Object.getOwnPropertyDescriptor(_class$1.prototype,"firstInvalidRef"),_class$1.prototype),_applyDecoratedDescriptor(_class$1.prototype,"valid",[computed],Object.getOwnPropertyDescriptor(_class$1.prototype,"valid"),_class$1.prototype),_applyDecoratedDescriptor(_class$1.prototype,"errorMessagesMap",[computed],Object.getOwnPropertyDescriptor(_class$1.prototype,"errorMessagesMap"),_class$1.prototype),_class$1),omit=function(e){for(var r=arguments.length,t=Array(r>1?r-1:0),o=1;o<r;o++)t[o-1]=arguments[o];var a=Object.assign({},e);return t.forEach(function(e){return delete a[e]}),a},Input=observer(_class$2=function(e){function r(){return classCallCheck(this,r),possibleConstructorReturn(this,(r.__proto__||Object.getPrototypeOf(r)).apply(this,arguments))}return inherits(r,e),createClass(r,[{key:"componentWillMount",value:function(){var e=this.props,r=e.store,t=e.name,o=e.value,a=e.validations;r.validationMap.set(t,a),r.valueMap.set(t,o||"")}},{key:"render",value:function(){var e=this.props,r=e.store,t=e.name,o=e.validOnBlur,a=e.onChange,i=e.onBlur;return React.createElement(FormControl,_extends({inputRef:function(e){return r.refs.set(t,e)},value:r.valueMap.get(t),onChange:function(e){r.valueMap.set(t,e.target.value||""),a&&a(e)},onBlur:function(e){o&&r.hasTried.set(t,!0),i&&i(e)}},omit(this.props,"store","value","validations","validOnBlur","onChange","onBlur")))}}]),r}(React.Component))||_class$2;Input.propTypes={store:PropTypes.object.isRequired,name:PropTypes.string.isRequired,onChange:PropTypes.func,onBlur:PropTypes.func,validOnBlur:PropTypes.bool,value:PropTypes.any,validations:PropTypes.arrayOf(PropTypes.instanceOf(Validation))};export{Validation,FormStore,Input};
//# sourceMappingURL=index.js.map
